<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>商品列表_蜗牛图书商城</title>
    <link type="text/css" rel="stylesheet" href="css/index.css">
</head>
<body class="index">
<div class="container">
    <header id="allHeader"></header>
    <div class="wrapper clearfix container_2">
        <div class="sidebar f_l">
            <!--销售排行-->
            <div class="box m_10">
                <div class="title">销售排行榜</div>
                <div class="content">
                    <ul class="ranklist" id="ranklist">
                        <li><span>1</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="陶渊明传论 20世纪伟大的文学批评家李长之先生的代表作，中国近现代陶渊明研究的扛鼎之作。被鲁迅先生视为天才并赠送照片的长之先生的天才之作。"
                                             title="陶渊明传论 20世纪伟大的文学批评家李长之先生的代表作，中国近现代陶渊明研究的扛鼎之作。被鲁迅先生视为天才并赠送照片的长之先生的天才之作。">陶渊明传论
                            20世纪伟大的文学批评家李长之先生的代表作，中国近现代陶渊明研究的扛鼎之作。被鲁迅先生视为天才并赠送照片的长之先生的天才之作。</a></li>
                        <li><span>2</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="辛弃疾传 辛稼轩年谱（新版） （辛弃疾，这样一位在宋代政治史和文学史上均具有举足轻重地位的人物，历来不乏论述。然能采征多方面史料，加以辨析考证，从而撰成系统全面之研究性传记者，则首推邓广铭先生之《辛弃疾传》。英雄虽逝，然其一生之）"
                                             title="辛弃疾传 辛稼轩年谱（新版） （辛弃疾，这样一位在宋代政治史和文学史上均具有举足轻重地位的人物，历来不乏论述。然能采征多方面史料，加以辨析考证，从而撰成系统全面之研究性传记者，则首推邓广铭先生之《辛弃疾传》。英雄虽逝，然其一生之）">辛弃疾传
                            辛稼轩年谱（新版）
                            （辛弃疾，这样一位在宋代政治史和文学史上均具有举足轻重地位的人物，历来不乏论述。然能采征多方面史料，加以辨析考证，从而撰成系统全面之研究性传记者，则首推邓广铭先生之《辛弃疾传》。英雄虽逝，然其一生之）</a>
                        </li>
                        <li><span>3</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="生活就是做简单的事 日本百年经典文学精选，跨越三个时代，影响日本人一个世纪的至简美学，宫崎骏、三岛由纪夫、川端康成、村上春树独爱有加"
                                             title="生活就是做简单的事 日本百年经典文学精选，跨越三个时代，影响日本人一个世纪的至简美学，宫崎骏、三岛由纪夫、川端康成、村上春树独爱有加">生活就是做简单的事
                            日本百年经典文学精选，跨越三个时代，影响日本人一个世纪的至简美学，宫崎骏、三岛由纪夫、川端康成、村上春树独爱有加</a></li>
                        <li><span>4</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="生活需要淡定感（《哈利・波特》作者J.K.罗琳 重点推荐） 畅销书《哈利・波特》作者J・K・罗琳：威廉姆・布鲁姆真是个天才。 终于有人将灵性的实相和现在社会上那些乱七八糟的说法区分开了。――荣获当当19698名读者全5星好评推荐！限时特惠，今日必抢！"
                                             title="生活需要淡定感（《哈利・波特》作者J.K.罗琳 重点推荐） 畅销书《哈利・波特》作者J・K・罗琳：威廉姆・布鲁姆真是个天才。 终于有人将灵性的实相和现在社会上那些乱七八糟的说法区分开了。――荣获当当19698名读者全5星好评推荐！限时特惠，今日必抢！">生活需要淡定感（《哈利・波特》作者J.K.罗琳
                            重点推荐） 畅销书《哈利・波特》作者J・K・罗琳：威廉姆・布鲁姆真是个天才。
                            终于有人将灵性的实相和现在社会上那些乱七八糟的说法区分开了。――荣获当当19698名读者全5星好评推荐！限时特惠，今日必抢！</a></li>
                        <li><span>5</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="独上高楼: 王国维传 王国维传*修订版 。较为完整地展示观堂生平、思想、学术的传记，鲜活地再现一代大师观堂的风貌，写出一个符合历史真实的王国维。"
                                             title="独上高楼: 王国维传 王国维传*修订版 。较为完整地展示观堂生平、思想、学术的传记，鲜活地再现一代大师观堂的风貌，写出一个符合历史真实的王国维。">独上高楼:
                            王国维传 王国维传*修订版 。较为完整地展示观堂生平、思想、学术的传记，鲜活地再现一代大师观堂的风貌，写出一个符合历史真实的王国维。</a></li>
                        <li><span>6</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="生活之书 引领时尚流行文化的日本潮牌BEAMS，献给你的生活风格教科书。分享超过400件生活好物，重新定义美好的生活方式。"
                                             title="生活之书 引领时尚流行文化的日本潮牌BEAMS，献给你的生活风格教科书。分享超过400件生活好物，重新定义美好的生活方式。">生活之书
                            引领时尚流行文化的日本潮牌BEAMS，献给你的生活风格教科书。分享超过400件生活好物，重新定义美好的生活方式。</a></li>
                        <li><span>7</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="企业经营管理实用必备工具箱.rar：常用制度、文书、表单、合同示例与应用(增订版) 常用制度、文书、表单、合同示例与应用,领导决策参考,干部管理指南，合规事务主管操作依据，人力资源经理必备工具。"
                                             title="企业经营管理实用必备工具箱.rar：常用制度、文书、表单、合同示例与应用(增订版) 常用制度、文书、表单、合同示例与应用,领导决策参考,干部管理指南，合规事务主管操作依据，人力资源经理必备工具。">企业经营管理实用必备工具箱.rar：常用制度、文书、表单、合同示例与应用(增订版)
                            常用制度、文书、表单、合同示例与应用,领导决策参考,干部管理指南，合规事务主管操作依据，人力资源经理必备工具。</a></li>
                        <li><span>8</span><a class="p_name" href="goodsDetail.html" target="_blank"
                                             alt="感谢生活（冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面） 冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面，虚构版《一百个人的十年》，中学语文阅读练习、考试高频率选用的名篇。三十多年斩获无数国内外奖项，译成多种语言。感谢生活的冷酷和坚硬，让我们变得更好。"
                                             title="感谢生活（冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面） 冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面，虚构版《一百个人的十年》，中学语文阅读练习、考试高频率选用的名篇。三十多年斩获无数国内外奖项，译成多种语言。感谢生活的冷酷和坚硬，让我们变得更好。">感谢生活（冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面）
                            冯骥才成名代表作，呈现他“俗世奇人”笔法之外的另一面，虚构版《一百个人的十年》，中学语文阅读练习、考试高频率选用的名篇。三十多年斩获无数国内外奖项，译成多种语言。感谢生活的冷酷和坚硬，让我们变得更好。</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!--销售排行-->
        </div>

        <div class="main f_r">
            <ul class="display_list clearfix m_10" id="goods">
            </ul>
            <div class="pages_bar" id="page-bar">
            </div>
        </div>
    </div>
    <footer id="allFooter"></footer>
</div>
<script src="js/jquery-3.4.1.js"></script>
<script src="js/includeAll.js"></script>
<script>
    $(function () {
        // 获取参数
        let cid = getUrlParam("cid");
        let searchname=sessionStorage.getItem("searchname");
        if (cid||searchname||searchname!="") {
            // 分类显示
            $.post("goods.do?method=search&searchByCategoryId=" + cid+"&searchByName="+searchname, function (result) {
                pageDisplay(result);
                sessionStorage.setItem("searchname","");
            }, "json")
        } else {
            //所有图书分页显示
            $.post("goods.do", "method=display&page=" + 1, function (result) {
                pageDisplay(result);
            }, "json");
        }

        //分页事件监听
        $("#page-bar").click(function (e) {
            let page = $(e.target).attr("value")
            if (page) {
                $.post("goods.do", "method=display&page=" + page, function (result) {
                    pageDisplay(result);
                }, "json");

            }
        });

        //展示
        function pageDisplay(result) {
            let goodsList = result.data;
            let pageInfo = result.pageInfo;
            let content = "";
            for (let i = 0; i < goodsList.length; i++) {
                content += "<li class='clearfix win'>" +
                    "<div class='pic'><a href='goodsDetail.html?gid="+goodsList[i].id+"' title=" + goodsList[i].author +
                    "> <img" + " src=" + goodsList[i].image + " width='200' height='200' style='cursor: pointer;'" +
                    " alt=" + goodsList[i].name + "(" + goodsList[i].description + ")" + " title=" + goodsList[i].name + "(" + goodsList[i].description + ")" + "></a></div>" +
                    "<h3 class='title'>" +
                    "<a class='p_name' href='goodsDetail.html?gid=" + goodsList[i].id + "' alt=" + goodsList[i].name +
                    "(" + goodsList[i].description + ")" + " title=" + goodsList[i].name + "(" + goodsList[i].description + ")" +
                    ">" + goodsList[i].name + "(" + goodsList[i].description + ")" + "</a> " +
                    "<span>总销量：" + goodsList[i].salenums + "</span></h3>" +
                    // "<div class='handle'><label class='btn_gray_m'><img src='images/front/ucenter/shopping.gif'" +
                    // "width='15' height='15'> <input type = 'button' value = '加入购物车'/> </label>" +
                    // "</div>" +
                    "<div class='price' style='padding-top:18px'>￥" + goodsList[i].salesprice + "<s>￥" + goodsList[i].marketprice + "</s></div>" +
                    "</li>"
            }
            $("#goods").html(content);
            //分页栏
            let pageContent = "";
            if (pageInfo.pageNum == 1) {
                pageContent += "<a style='background-color: grey;color: white'>上一页</a>";
            } else {
                pageContent += "<a value=" + pageInfo.prePage + ">上一页</a>";
            }
            for (let i = 1; i < pageInfo.pages + 1; i++) {
                if (pageInfo.pageNum == i) {
                    pageContent += "<a class=\"current_page\" style='background-color: grey;color: white'>" + i + "</a>";
                } else {
                    pageContent += "<a class=\"current_page\"  value=" + i + ">" + i + "</a>";
                }
            }
            if (pageInfo.pageNum == pageInfo.pages) {
                pageContent += "<a style='background-color: grey;color: white'>下一页</a>";
            } else {
                pageContent += "<a value=" + pageInfo.nextPage + ">下一页</a>";
            }
            pageContent += "当前第<span id=\"currentPage\">" + pageInfo.pageNum + "</span>页 共 <span id = \"totalPage\" > " + pageInfo.pages + " </span>页";
            $("#page-bar").html(pageContent);
        }

        //获取url中的参数
        function getUrlParam(name) {
            let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            let r = window.location.search.substr(1).match(reg);  //匹配目标参数
            if (r != null) return unescape(r[2]);
            return null; //返回参数值
        }
    })
</script>
</body>
</html>




